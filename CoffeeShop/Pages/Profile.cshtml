@page
@model ProfileModel
<style>
    body, html {
        height: 100%;
        margin: 0;
        padding: 0;
    }
    .profile-bg {
        background: url('/images/coffee-beans-2258839-960.jpg') center center no-repeat;
        background-attachment: fixed;
        background-size: cover;
        min-height: 100vh;
        width: 100vw;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .profile-card {
        max-width: 1300px;
        width: 100%;
        border-radius: 28px;
        box-shadow: 0 12px 40px rgba(44, 41, 92, 0.22);
        background: rgba(255,255,255,0.40);
        backdrop-filter: blur(24px);
        padding: 2.8rem 2.2rem 2.2rem 2.2rem;
        margin: 32px 0;
        border: 1.5px solid rgba(210,168,106,0.18);
        transition: box-shadow 0.2s;
    }
    .profile-header {
        color: #fff;
        font-size: 2.5rem;
        font-weight: 800;
        letter-spacing: 1px;
        text-align: center;
        margin-bottom: 2rem;
        text-shadow: 0 2px 8px rgba(44,41,92,0.08);
    }
    .profile-title-gradient {
        background: linear-gradient(90deg, #ff9800 0%, #43c6ac 50%, #283593 100%);
        color: #fff;
        padding: 1.2rem 0;
        border-radius: 18px;
        font-size: 2.7rem;
        font-weight: 900;
        text-align: center;
        box-shadow: 0 4px 16px rgba(44,41,92,0.12);
        margin-bottom: 2.2rem;
        letter-spacing: 2px;
        text-shadow: 0 2px 8px rgba(44,41,92,0.18);
    }
    .profile-info {
        background: rgba(255,255,255,0.7);
        border-radius: 18px;
        padding: 2rem;
        margin-bottom: 2rem;
        box-shadow: 0 4px 16px rgba(44,41,92,0.10);
    }
    .profile-info h4 {
        font-weight: 700;
        color: #2d295c;
        margin-bottom: 1.2rem;
    }
    .profile-info p {
        font-size: 1.1rem;
        margin-bottom: 0.7rem;
    }
    .btn-edit-profile {
        background: linear-gradient(90deg, #00796b 0%, #ff9800 100%);
        color: #fff;
        font-weight: 700;
        border-radius: 10px;
        border: none;
        margin-right: 0.7rem;
        font-size: 1.1rem;
        padding: 0.7rem 2.2rem;
        box-shadow: 0 2px 8px rgba(44, 41, 92, 0.08);
    }
    .btn-edit-profile:hover, .btn-edit-profile:focus {
        background: linear-gradient(90deg, #ff9800 0%, #00796b 100%);
        color: #fff;
        box-shadow: 0 4px 16px rgba(44,41,92,0.12);
    }
    .btn-change-password {
        background: linear-gradient(90deg, #c62828 0%, #283593 100%);
        color: #fff;
        font-weight: 700;
        border-radius: 10px;
        border: none;
        font-size: 1.1rem;
        padding: 0.7rem 2.2rem;
        box-shadow: 0 2px 8px rgba(44, 41, 92, 0.08);
    }
    .btn-change-password:hover, .btn-change-password:focus {
        background: linear-gradient(90deg, #283593 0%, #c62828 100%);
        color: #fff;
        box-shadow: 0 4px 16px rgba(44,41,92,0.12);
    }
    .order-history-card {
        background: rgba(255,255,255,0.7);
        border-radius: 18px;
        padding: 2rem;
        box-shadow: 0 4px 16px rgba(44,41,92,0.10);
    }
    .order-history-card h4 {
        font-weight: 700;
        color: #2d295c;
        margin-bottom: 1.2rem;
    }
    .order-details-list {
        list-style: none;
        padding: 0;
        margin: 0;
    }
    .order-details-list li {
        font-size: 1rem;
        margin-bottom: 0.3rem;
    }
    .order-status-approved { color: #00796b; font-weight: 700; }
    .order-status-cancelled { color: #c62828; font-weight: 700; }
    .order-status-pending { color: #6a1b9a; font-weight: 700; }
    .contact-alert-gradient {
        background: linear-gradient(90deg, #ff9800 0%, #f8ffae 50%, #43c6ac 100%);
        color: #2d295c;
        border-radius: 12px;
        padding: 1.5rem;
        transition: background 0.5s;
    }
    .contact-alert-gradient.active {
        background: linear-gradient(90deg, #283593 0%, #c62828 100%);
        color: #fff;
    }
    .contact-alert-gradient .btn-contact {
        background: #b88a4a;
        color: #fff;
        font-weight: 700;
        border-radius: 8px;
        border: none;
        padding: 0.7rem 2rem;
        margin-top: 1rem;
        box-shadow: 0 2px 8px rgba(44,41,92,0.08);
        transition: background 0.3s;
    }
    .contact-alert-gradient .btn-contact:hover {
        background: #ff9800;
        color: #fff;
    }
    .status-box {
        display: inline-block;
        padding: 0.6rem 1.4rem;
        border-radius: 14px;
        font-weight: 700;
        font-size: 1.1rem;
        box-shadow: 0 2px 8px rgba(44,41,92,0.10);
        margin: 0.2rem 0;
        letter-spacing: 1px;
    }
    .status-approved {
        background: linear-gradient(90deg, #43c6ac 0%, #f8ffae 100%);
        color: #0a4d4d;
        border: 2px solid #43c6ac;
    }
    .status-cancelled {
        background: linear-gradient(90deg, #ff6e7f 0%, #bfe9ff 100%);
        color: #c62828;
        border: 2px solid #c62828;
    }
    .status-pending {
        background: linear-gradient(90deg, #f7971e 0%, #ffd200 100%);
        color: #6a1b9a;
        border: 2px solid #6a1b9a;
    }
    .response-box {
        display: inline-block;
        padding: 0.6rem 1.4rem;
        border-radius: 14px;
        font-weight: 700;
        font-size: 1.1rem;
        box-shadow: 0 2px 8px rgba(44,41,92,0.10);
        margin: 0.2rem 0;
        letter-spacing: 1px;
    }
    .response-none {
        background: linear-gradient(90deg, #f8ffae 0%, #ff9800 100%);
        color: #2d295c;
        border: 2px solid #ff9800;
    }
    .response-replied {
        background: linear-gradient(90deg, #283593 0%, #43c6ac 100%);
        color: #fff;
        border: 2px solid #283593;
    }
    @@media (max-width: 900px) {
        .profile-card { max-width: 98vw; margin: 16px auto; padding: 1.2rem 0.5rem; }
        .profile-header { font-size: 1.5rem; }
    }
</style>
@{
    ViewData["Title"] = "My Profile";
}
<div class="profile-bg">
    <div class="profile-card">
        <div class="profile-title-gradient">My Profile</div>
        <div class="row">
            <div class="col-md-4">
                <div class="profile-info">
                    <h4>Profile Info</h4>
                    <p><strong>Name:</strong> @Model.UserInfo?.FirstName @Model.UserInfo?.LastName</p>
                    <p><strong>Email:</strong> @Model.UserInfo?.Email</p>
                    <p><strong>Phone:</strong> @Model.UserInfo?.PhoneNumber</p>
                    <p><strong>Address:</strong> @Model.UserInfo?.Address</p>
                    <a class="btn btn-edit-profile" asp-page="/EditProfile">Edit Profile</a>
                    <a class="btn btn-change-password" asp-page="/ChangePassword">Change Password</a>
                </div>
            </div>
            <div class="col-md-8">
                <div class="order-history-card">
                    <h4>Order History</h4>
                    @if (Model.Orders != null && Model.Orders.Any())
                    {
                        <table class="table table-bordered">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Total</th>
                                    <th>Details</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var order in Model.Orders)
                                {
                                    <tr>
                                        <td>@order.OrderPlaced.ToLocalTime().ToString("g")</td>
                                        <td>@order.OrderTotal.ToString("C")</td>
                                        <td>
                                            <ul class="order-details-list">
                                                @foreach (var detail in order.OrderDetails)
                                                {
                                                    <li>@detail.Product?.Name x @detail.Quantity (@detail.Price.ToString("C") each)</li>
                                                }
                                            </ul>
                                        </td>
                                        <td>
                                            @if (order.Status == "Approved")
                                            {
                                                <span class="status-box status-approved">Your order fulfilled</span>
                                            }
                                            else if (order.Status == "Cancelled")
                                            {
                                                <span class="status-box status-cancelled">Sorry! Coffee is out</span>
                                            }
                                            else
                                            {
                                                <span class="status-box status-pending">Pending</span>
                                            }
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    }
                    else
                    {
                        <div id="orderAlert" class="contact-alert-gradient d-flex flex-column align-items-center">
                            <span>You have not placed any orders yet.</span>
                            <a href="/Products/Shop" class="btn btn-success mt-3" style="font-weight:600;" onclick="activateOrderAlert()">
                                Explore best Sips Now!
                            </a>
                        </div>
                    }
                </div>
                <div class="order-history-card mt-4">
                    <h4>Contact Info</h4>
                    @if (Model.ContactMessages != null && Model.ContactMessages.Any())
                    {
                        <table class="table table-bordered">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Name</th>
                                    <th>Message</th>
                                    <th>Coffee Crew Response</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var msg in Model.ContactMessages)
                                {
                                    <tr>
                                        <td>@msg.SubmittedAt.ToLocalTime().ToString("g")</td>
                                        <td>@msg.Name</td>
                                        <td>@msg.Message</td>
                                        <td>
                                            @if (string.IsNullOrWhiteSpace(msg.AdminReply))
                                            {
                                                <span class="response-box response-none">No reply from Crew yet.</span>
                                            }
                                            else
                                            {
                                                <span class="response-box response-replied">@msg.AdminReply</span>
                                            }
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    }
                    else
                    {
                        <div id="contactAlert" class="contact-alert-gradient d-flex flex-column align-items-center">
                            <span>Oops, no contact info yet. Want to break the silence?</span>
                            <a href="/Contact" class="btn btn-contact mt-3" style="font-weight:600;" onclick="activateContactAlert()">
                                Contact Us
                            </a>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    function activateContactAlert() {
        var alertDiv = document.getElementById('contactAlert');
        if (alertDiv) {
            alertDiv.classList.add('active');
        }
    }
    function activateOrderAlert() {
        var alertDiv = document.getElementById('orderAlert');
        if (alertDiv) {
            alertDiv.classList.add('active');
        }
    }
</script>